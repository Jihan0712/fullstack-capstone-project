{"ast":null,"code":"import React,{useState,useEffect}from'react';import{urlConfig}from'../../config';// Import backend URL configuration\nimport{useAppContext}from'../../context/AuthContext';// Import AuthContext\nimport{useNavigate}from'react-router-dom';// For navigation\nimport'./LoginPage.css';// Import CSS file\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function LoginPage(){const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[incorrect,setIncorrect]=useState('');// State for error messages\nconst navigate=useNavigate();// For programmatic navigation\nconst bearerToken=sessionStorage.getItem('auth-token');// Check if user is already logged in\nconst{setIsLoggedIn,setUserName}=useAppContext();// Global state management\n// Redirect if user is already logged in\nuseEffect(()=>{if(bearerToken){navigate('/app');}},[navigate,bearerToken]);const handleLogin=async()=>{try{console.log(\"Inside handleLogin\");console.log({email,password});// Task 1: Access data coming from fetch API\nconst response=await fetch(\"\".concat(urlConfig.backendUrl,\"/api/auth/login\"),{method:'POST',headers:{'Content-Type':'application/json',Authorization:bearerToken?\"Bearer \".concat(bearerToken):''},body:JSON.stringify({email,password})});const json=await response.json();// Parse JSON response\nif(response.ok){// Task 2: Set user details in session storage\nsessionStorage.setItem('auth-token',json.authtoken);sessionStorage.setItem('name',json.userName);sessionStorage.setItem('email',json.userEmail);// Task 3: Set the user's state to log in using the useAppContext\nsetIsLoggedIn(true);setUserName(json.userName);// Task 4: Navigate to the MainPage after logging in\nnavigate('/app');}else{// Task 5: Clear input and set an error message if the password is incorrect\nsetEmail('');setPassword('');setIncorrect(\"Wrong password. Try again.\");// Optional: Clear out error message after 2 seconds\nsetTimeout(()=>{setIncorrect(\"\");},2000);}}catch(e){console.error('Error during login:',e.message);setIncorrect('An unexpected error occurred. Please try again.');}};return/*#__PURE__*/_jsx(\"div\",{className:\"container mt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 col-lg-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-card p-4 border rounded shadow-sm\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center mb-4 font-weight-bold\",children:\"Login\"}),incorrect&&/*#__PURE__*/_jsx(\"p\",{className:\"text-danger text-center\",children:incorrect}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>e.preventDefault(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",className:\"form-label\",children:\"Email address\"}),/*#__PURE__*/_jsx(\"input\",{id:\"email\",type:\"email\",className:\"form-control\",placeholder:\"Enter your email\",value:email,onChange:e=>setEmail(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"form-label\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{id:\"password\",type:\"password\",className:\"form-control\",placeholder:\"Enter your password\",value:password,onChange:e=>setPassword(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary w-100 mb-3\",onClick:handleLogin,type:\"button\",children:\"Login\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-4 text-center\",children:[\"New here? \",/*#__PURE__*/_jsx(\"a\",{href:\"/app/register\",className:\"text-primary\",children:\"Register Here\"})]})]})})})});}export default LoginPage;","map":{"version":3,"names":["React","useState","useEffect","urlConfig","useAppContext","useNavigate","jsx","_jsx","jsxs","_jsxs","LoginPage","email","setEmail","password","setPassword","incorrect","setIncorrect","navigate","bearerToken","sessionStorage","getItem","setIsLoggedIn","setUserName","handleLogin","console","log","response","fetch","concat","backendUrl","method","headers","Authorization","body","JSON","stringify","json","ok","setItem","authtoken","userName","userEmail","setTimeout","e","error","message","className","children","onSubmit","preventDefault","htmlFor","id","type","placeholder","value","onChange","target","required","onClick","href"],"sources":["/home/project/fullstack-capstone-project/giftlink-frontend/src/components/LoginPage/LoginPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { urlConfig } from '../../config'; // Import backend URL configuration\nimport { useAppContext } from '../../context/AuthContext'; // Import AuthContext\nimport { useNavigate } from 'react-router-dom'; // For navigation\nimport './LoginPage.css'; // Import CSS file\n\nfunction LoginPage() {\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n    const [incorrect, setIncorrect] = useState(''); // State for error messages\n\n    const navigate = useNavigate(); // For programmatic navigation\n    const bearerToken = sessionStorage.getItem('auth-token'); // Check if user is already logged in\n    const { setIsLoggedIn, setUserName } = useAppContext(); // Global state management\n\n    // Redirect if user is already logged in\n    useEffect(() => {\n        if (bearerToken) {\n            navigate('/app');\n        }\n    }, [navigate, bearerToken]);\n\n    const handleLogin = async () => {\n        try {\n            console.log(\"Inside handleLogin\");\n            console.log({\n                email,\n                password\n            });\n    \n            // Task 1: Access data coming from fetch API\n            const response = await fetch(`${urlConfig.backendUrl}/api/auth/login`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    Authorization: bearerToken ? `Bearer ${bearerToken}` : '',\n                },\n                body: JSON.stringify({\n                    email,\n                    password,\n                }),\n            });\n    \n            const json = await response.json(); // Parse JSON response\n    \n            if (response.ok) {\n                // Task 2: Set user details in session storage\n                sessionStorage.setItem('auth-token', json.authtoken);\n                sessionStorage.setItem('name', json.userName);\n                sessionStorage.setItem('email', json.userEmail);\n    \n                // Task 3: Set the user's state to log in using the useAppContext\n                setIsLoggedIn(true);\n                setUserName(json.userName);\n    \n                // Task 4: Navigate to the MainPage after logging in\n                navigate('/app');\n            } else {\n                // Task 5: Clear input and set an error message if the password is incorrect\n                setEmail('');\n                setPassword('');\n                setIncorrect(\"Wrong password. Try again.\");\n    \n                // Optional: Clear out error message after 2 seconds\n                setTimeout(() => {\n                    setIncorrect(\"\");\n                }, 2000);\n            }\n        } catch (e) {\n            console.error('Error during login:', e.message);\n            setIncorrect('An unexpected error occurred. Please try again.');\n        }\n    };\n\n    return (\n        <div className=\"container mt-5\">\n            <div className=\"row justify-content-center\">\n                <div className=\"col-md-6 col-lg-4\">\n                    <div className=\"login-card p-4 border rounded shadow-sm\">\n                        <h2 className=\"text-center mb-4 font-weight-bold\">Login</h2>\n\n                        {/* Error Message */}\n                        {incorrect && <p className=\"text-danger text-center\">{incorrect}</p>}\n\n                        <form onSubmit={(e) => e.preventDefault()}>\n                            <div className=\"mb-3\">\n                                <label htmlFor=\"email\" className=\"form-label\">Email address</label>\n                                <input\n                                    id=\"email\"\n                                    type=\"email\"\n                                    className=\"form-control\"\n                                    placeholder=\"Enter your email\"\n                                    value={email}\n                                    onChange={(e) => setEmail(e.target.value)}\n                                    required\n                                />\n                            </div>\n\n                            <div className=\"mb-3\">\n                                <label htmlFor=\"password\" className=\"form-label\">Password</label>\n                                <input\n                                    id=\"password\"\n                                    type=\"password\"\n                                    className=\"form-control\"\n                                    placeholder=\"Enter your password\"\n                                    value={password}\n                                    onChange={(e) => setPassword(e.target.value)}\n                                    required\n                                />\n                            </div>\n\n                            <button\n                                className=\"btn btn-primary w-100 mb-3\"\n                                onClick={handleLogin}\n                                type=\"button\"\n                            >\n                                Login\n                            </button>\n                        </form>\n\n                        <p className=\"mt-4 text-center\">\n                            New here? <a href=\"/app/register\" className=\"text-primary\">Register Here</a>\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default LoginPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}